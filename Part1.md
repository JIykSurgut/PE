## DOS Header
|offset|          |     |       |                                                                     |
|------|----------|-----|-------|---------------------------------------------------------------------|
|0x00  |e_magic   |4d 5a|MZ     |Магическое число                                                     |
|0x02  |e_cblp    |90 00|144    |Количество байт на последней странице файла                          |
|0x04  |e_cp      |03 00|3      |Общее количество страниц в файле                                     |
|0x06  |e_crlc    |00 00|0      |Количество релокаций                                                 |
|0x08  |e_cparhdr |04 00|4      |Размер заголовка в абзацах                                           |
|0x0a  |e_minalloc|00 00|0      |Минимальное количество абзацев, которые нужны сверх размера заголовка|
|0x0c  |e_maxalloc|ff ff|65535  |Максимальное количество абзацев, которые можно выделить              |
|0x0e  |e_ss      |00 00|0000   |Начальное значение регистра SS                                       |
|0x10  |e_sp      |b8 00|00b8   |Начальное значение регистра SP                                       |
|0x12  |e_csum    |00 00|0000   |Контрольная сумма файла                                              |
|0x14  |e_ip      |00 00|0000   |Начальное значение регистра IP                                       |
|0x16  |e_cs      |00 00|0000   |Начальное значение регистра CS                                       |
|0x18  |e_lfarlc  |40 00|0040   |Адрес таблицы релокаций в файле                                      |
|0x1a  |e_ovno    |00 00|0      |Номер оверлея                                                        |
|0x1c  |e_res[4]  |00 00 00 00| |Зарезервированные слова                                              |
|0x24  |e_oemid   |00 00|00 00  |Идентификатор OEM                                                    |
|0x26  |e_oeminfo |00 00|00 00  |Информация OEM, специфичная для e_oemid                              |
|0x28  |e_res2[10]|00 00 ..|00 00 ..  |Зарезервированные слова                                        |
|0x3c  |e_lfanew  |48 01 |01 48 |Адрес нового заголовка исполняемого файла в файле                    |

## DOS stub
|offset  |
|--------|
|0x00 3e |
|...     |
|0x01 47 |

## PE заголовок
|offset |                    |           |           |                                                                       |
|-------|--------------------|-----------|-----------|-----------------------------------------------------------------------|
|0x01 48|Signature           |50 45 00 00|00 00 45 50|Сигнатура                                                              |
|       |                    |           |           |                                                                       |
|0x01 4c|Machine             |68 86      |86 68      |указывает тип машины                                                   |
|0x01 4e|NumberOfSections    |07 00      |00 07      |количество секций в файле                                              |
|0x01 50|TimeDateStamp       |6a e6 bc 65|65 bc e6 6a|временная метка создания файла                                         |
|0x01 54|PointerToSymbolTable|00 00 00 00|00 00 00 00|указатель на таблицу символов для отладки                              |
|0x01 58|NumberOfSymbols     |00 00 00 00|00 00 00 00|количество символов в таблице символов                                 |
|0x01 5c|SizeOfOptionalHeader|f0 00      |00 f0      |размер заголовка IMAGE_OPTIONAL_HEADER, следующего за IMAGE_FILE_HEADER (240 байт)|
|0x01 5e|Characteristics     |22 00      |00 22      |флаги, описывающие характеристики файла (34)                           |
|       |                    |           |           |                                                                       |





